// This is an autogenerated file from Firebase Studio.
'use server';
import { db } from '@/lib/firebase';
import type { CustomMeal } from '@/lib/types';
import { collection, getDocs, addDoc } from 'firebase/firestore';

const mealCollection = collection(db, 'customMeals');

export async function getCustomMeals(): Promise<CustomMeal[]> {
    const snapshot = await getDocs(mealCollection);
    return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as CustomMeal));
}

export async function addCustomMeal(meal: Omit<CustomMeal, 'id'>): Promise<CustomMeal> {
    try {
        const docRef = await addDoc(mealCollection, meal);
        return { id: docRef.id, ...meal };
    } catch (error) {
        console.error("Error adding document to Firestore: ", error);
        // Re-throw the error to be caught by the calling function
        if (error instanceof Error) {
            throw new Error(`Firestore error: ${error.message}`);
        }
        throw new Error('An unknown error occurred while saving to Firestore.');
    }
}

    